<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>üß†</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap" rel="stylesheet">

<style>
html, body { height: 100%; margin: 0; }
body {
  display: grid; place-items: center;
  background: #000; color: white;
  font-family: Arial, sans-serif; text-align: center;
}
#gameContainer {
  width: 90%; max-width: 700px; min-height: 520px;
  padding: 20px; background: #000; border-radius: 15px;
  box-shadow: 0 0 25px rgba(255,255,255,0.08);
  display: flex; flex-direction: column; align-items: center; justify-content: center;
}
h1 {
  font-size: 1.8em; margin-bottom: 20px;
  color: #4dd0e1; font-family: 'Press Start 2P', cursive;
}
#task, #wordDisplay {
  font-size: 1.4em; margin: 20px 0; min-height: 50px;
  font-family: 'Press Start 2P', cursive;
}
#inputContainer { display:flex; flex-direction:column; align-items:center; }
#playerWord, #answer {
  width:80%; max-width:400px; padding:10px;
  border-radius:10px; border:none; margin-bottom:15px;
  text-align:center;
}
button {
  padding:12px 25px; border:none; border-radius:10px;
  background:#2e7d32; color:white; cursor:pointer;
}
button:hover { background:#4caf50; }

#message { min-height:40px; }
#timer { font-weight:bold; margin-top:10px; }
.timer-green{color:#4caf50}
.timer-yellow{color:#ffc107}
.timer-red{color:#f44336}

/* TicTacToe */
#board { display:grid; grid-template-columns:repeat(3,120px); gap:12px; }
.cell {
  width:120px; height:120px;
  display:flex; align-items:center; justify-content:center;
  font-size:48px; border-radius:15px;
  cursor:pointer; font-weight:bold;
}

/* ? HELP */
#helpBtn{
  position:fixed; bottom:20px; right:20px;
  font-size:26px; background:none; border:none;
  color:white; cursor:pointer;
}
#helpBtn:hover{color:#4dd0e1}
#helpModal{
  display:none; position:fixed; inset:0;
  background:rgba(0,0,0,.7);
}
#helpBox{
  background:#111; padding:20px; border-radius:12px;
  width:80%; max-width:400px; margin:20% auto;
  text-align:left;
}
</style>
</head>

<body>

<div id="gameContainer">
  <h1>üß†</h1>
  <button onclick="startWordChain()">START</button>
</div>

<button id="helpBtn">?</button>
<div id="helpModal">
  <div id="helpBox">
    <h3>üí° Help</h3>
    <ul>
      <li>Word ‚Üí last letter rule</li>
      <li>TicTacToe ‚Üí beat AI</li>
      <li>Math ‚Üí 9 correct</li>
      <li>Chromatic ‚Üí same color</li>
    </ul>
    <button onclick="closeHelp()">OK</button>
  </div>
</div>

<script>
// ================= HELP =================
function closeHelp(){ document.getElementById('helpModal').style.display='none'; }
document.getElementById('helpBtn').onclick=()=>document.getElementById('helpModal').style.display='block';

// ================= VARIABLES =================
let stage='start', wordScore=0;
let currentWord='', usedWords=[], wordList=[];
let board=[], gameOver=false;
let timer=6, timerInterval;

// ================= WORD CHAIN =================
function startWordChain(){
  stage='word';
  gameContainer.innerHTML=`
    <h1></h1>
    <div id="wordDisplay">Apple</div>
    <input id="playerWord">
    <button onclick="playWord()">OK</button>
    <div id="message"></div>
  `;
  currentWord='Apple';
  usedWords=[currentWord];
  wordList=["Apple","Elephant","Tiger","Rabbit","Tree","Eagle","Egg","Giraffe"];
}

function playWord(){
  const input=playerWord.value.trim();
  if(!input)return;
  const word=input[0].toUpperCase()+input.slice(1);
  if(word[0].toLowerCase()!==currentWord.slice(-1).toLowerCase()){
    message.textContent="‚ùå Wrong";
    return;
  }
  usedWords.push(word);
  currentWord=word;
  wordDisplay.textContent=word;
  playerWord.value='';
  setTimeout(aiTurn,500);
}

function aiTurn(){
  wordScore++;
  if(wordScore>=6) setTimeout(startTicTacToe,700);
}

// ================= TIC TAC TOE =================
function startTicTacToe(){
  stage='tic';
  gameContainer.innerHTML=`
    <div id="board"></div>
    <div id="timer"></div>
    <div id="message"></div>
  `;
  board=['','','','','','','','',''];
  renderBoard();
  startTimer();
}

function renderBoard(){
  boardEl=document.getElementById('board');
  boardEl.innerHTML='';
  board.forEach((v,i)=>{
    const d=document.createElement('div');
    d.className='cell';
    d.textContent=v;
    d.onclick=()=>playerMove(i);
    boardEl.appendChild(d);
  });
}

function startTimer(){
  clearInterval(timerInterval);
  timer=6;
  timerInterval=setInterval(()=>{
    timer--;
    timerDiv.textContent=`‚è≥ ${timer}`;
    if(timer<=0) clearInterval(timerInterval);
  },1000);
}
  // ================= MATH =================
let correctAnswer=0, correctMathCount=0;
let mathTimer=30, mathTimerInterval;

function startMathChallenge(){
  stage='math';
  gameContainer.innerHTML=`
    <div id="task"></div>
    <input id="answer">
    <button onclick="checkMathAnswer()">OK</button>
    <div id="timer"></div>
  `;
  generateMathTask();
  startMathTimer();
}

function generateMathTask(){
  const a=Math.floor(Math.random()*20)+10;
  const b=Math.floor(Math.random()*10)+2;
  correctAnswer=a+b;
  task.textContent=`${a} + ${b}`;
}

function startMathTimer(){
  clearInterval(mathTimerInterval);
  mathTimerInterval=setInterval(()=>{
    mathTimer--;
    if(mathTimer<=0) restartGame();
  },1000);
}

function checkMathAnswer(){
  if(Number(answer.value)===correctAnswer){
    correctMathCount++;
    if(correctMathCount>=9) startChromaticTrial();
    else generateMathTask();
  }else restartGame();
}

// ================= CHROMATIC =================
const colors=["#e57373","#64b5f6","#81c784","#ba68c8"];
let tiles=[], chromaticTimer=60, chromaticInterval;

function startChromaticTrial(){
  stage='chromatic';
  gameContainer.innerHTML=`<div id="grid"></div><div id="timer"></div>`;
  grid.innerHTML='';
  for(let i=0;i<9;i++){
    const d=document.createElement('div');
    d.className='tile';
    d.style.background=colors[Math.floor(Math.random()*colors.length)];
    d.onclick=()=>cycle(d);
    grid.appendChild(d);
  }
  startChromaticTimer();
}

function cycle(t){
  let i=colors.indexOf(t.style.background);
  t.style.background=colors[(i+1)%colors.length];
}

function startChromaticTimer(){
  chromaticInterval=setInterval(()=>{
    chromaticTimer--;
    if(chromaticTimer<=0) restartGame();
  },1000);
}

// ================= RESTART =================
function restartGame(){
  clearInterval(timerInterval);
  clearInterval(mathTimerInterval);
  clearInterval(chromaticInterval);
  gameContainer.innerHTML=`<h1>üß†</h1><button onclick="startWordChain()">START</button>`;
}
</script>
</body>
</html>
